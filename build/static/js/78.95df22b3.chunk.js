"use strict";(self.webpackChunkclient360=self.webpackChunkclient360||[]).push([[78],{60078:function(e,l,i){i.r(l);var a=i(97890),o=i(75419),n=i(85833),t=i(65954),r=i(98616),d=i(67662),s=i(47313),c=i(41806),u=i(61113),p=i(47825),x=i(42832),h=i(31095),v=i(73428),m=i(36305),g=i(10237),j=i(51997),b=i(17592),w=i(17551),f=i(83965),Z=i(43997),C=i(85582),S=i(51405),_=i(6210),y=i(47131),k=i(16633),N=i(39810),R=i(24249),D=i(46808),M=i(5833),E=i(70816),z=i.n(E),P=i(46417);const I=(0,b.ZP)((e=>(0,P.jsx)(C.Z,{elevation:0,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},...e})))((e=>{let{theme:l}=e;return{"& .MuiPaper-root":{borderRadius:6,marginTop:l.spacing(1),minWidth:180,color:"light"===l.palette.mode?"rgb(55, 65, 81)":l.palette.grey[300],boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px","& .MuiMenu-list":{padding:"4px 0"},"& .MuiMenuItem-root":{"& .MuiSvgIcon-root":{fontSize:18,color:l.palette.text.secondary,marginRight:l.spacing(1.5)},"&:active":{backgroundColor:(0,w.Fq)(l.palette.primary.main,l.palette.action.selectedOpacity)}}}}}));l.default=()=>{const e=(0,a.s0)(),[l,i]=(0,s.useState)(!1),[b,w]=(0,s.useState)(!1),[C,E]=(0,s.useState)(!1),[O,F]=s.useState(null),[L,Y]=(0,s.useState)(!1),[$,A]=(0,s.useState)(!1),[T,q]=(0,s.useState)([]),[J,Q]=(0,s.useState)([]),[V,W]=(0,s.useState)(null),B=JSON.parse(localStorage.getItem("user")),G=O,H=()=>{F(null)},[K,U]=(0,s.useState)([]),[X,ee]=(0,s.useState)([]),le=()=>{const e=K.filter((e=>!(!e.call_analysis||"Positive"!==e.call_analysis.agent_sentiment))),l={caller_number:"leadPhoneNumber",caller_name:"leadName",caller_email:"leadEmail",start_time:"updatedDate"},i=e.map(((e,i)=>function(e,l,i){const a={};return Object.keys(e).forEach((i=>{i in l?a[l[i]]=e[i]:a[i]=e[i]})),a}(e,l)));ee(i)};(0,s.useEffect)((()=>{(async()=>{try{const e=await(0,_.ac)("api/llm//llmleadCalls");U(e.data.result)}catch(e){console.log(e)}})(),(async()=>{try{const e=await(0,_.ac)("admin"===B.role?"api/lead/viewallleads":`api/lead/viewuserleads/${B._id}`);q(null===e||void 0===e?void 0:e.data)}catch(e){console.log(e)}})()}),[l,b,C]),(0,s.useEffect)((()=>{le()}),[K]);let ie=0;const[ae,oe]=(0,s.useState)([]);(0,s.useEffect)((()=>{ne()}),[X]);const ne=()=>{console.log(X);const e=X.concat(T);e.sort(((e,l)=>new Date(e.updatedDate)-new Date(l.updatedDate))),oe(e)};console.log("newData",ae);const te=[{field:"id",headerName:"#",flex:1,renderCell:()=>(0,P.jsx)(c.Z,{children:ie+=1})},{field:"leadName",headerName:"Name",flex:1,cellClassName:"name-column--cell name-column--cell--capitalize",renderCell:l=>(0,P.jsx)(c.Z,{onClick:()=>{e(`/dashboard/lead/view/${null!==l&&void 0!==l&&l.row._id?null===l||void 0===l?void 0:l.row._id:null===l||void 0===l?void 0:l.row.call_id}`)},children:null!==l&&void 0!==l&&l.value?null===l||void 0===l?void 0:l.value:"No Name"})},{field:"leadEmail",headerName:"Email",flex:1},{field:"leadPhoneNumber",headerName:"Phone Number",flex:1},{field:"action",headerName:"Action",flex:1,renderCell:l=>(0,P.jsx)(P.Fragment,{children:(0,P.jsxs)("div",{children:[(0,P.jsx)(y.Z,{"aria-label":"more",id:"long-button","aria-controls":G?"long-menu":void 0,"aria-expanded":G?"true":void 0,"aria-haspopup":"true",onClick:()=>{return e=null===l||void 0===l?void 0:l.row._id,void F(e);var e},children:(0,P.jsx)(Z.Z,{})}),(0,P.jsxs)(I,{id:"demo-customized-menu",MenuListProps:{"aria-labelledby":"demo-customized-button"},anchorEl:O===(null===l||void 0===l?void 0:l.row._id),open:G===(null===l||void 0===l?void 0:l.row._id),onClose:H,children:[(0,P.jsxs)(S.Z,{onClick:()=>{return e=null===l||void 0===l?void 0:l.row,Q(e),w(!0),void console.log(b);var e},disableRipple:!0,children:[(0,P.jsx)(t.Z,{style:{marginRight:"8px"}}),"Edit"]}),(0,P.jsxs)(S.Z,{onClick:()=>{return e=null===l||void 0===l?void 0:l.row._id,W(e),void A(!0);var e},disableRipple:!0,children:[(0,P.jsx)(m.Z,{style:{marginRight:"8px"}}),"Create Call"]}),(0,P.jsxs)(S.Z,{onClick:()=>{return e=null===l||void 0===l?void 0:l.row._id,W(e),void Y(!0);var e},disableRipple:!0,children:[(0,P.jsx)(f.Z,{style:{marginRight:"8px"}}),"Send Email"]}),(0,P.jsxs)(S.Z,{onClick:()=>{return i=null===l||void 0===l?void 0:l.row._id,void e(`/dashboard/lead/view/${i}`);var i},disableRipple:!0,children:[(0,P.jsx)(g.Z,{style:{marginRight:"8px",color:"green"}}),"View"]}),(0,P.jsxs)(S.Z,{onClick:()=>{return e=null===l||void 0===l?void 0:l.row._id,console.log(e),W(e),void E(!0);var e},sx:{color:"red"},disableRipple:!0,children:[(0,P.jsx)(j.Z,{style:{marginRight:"8px",color:"red"}}),"Delete"]})]})]})})},{field:"Date",headerName:"Date",flex:1,renderCell:e=>{var l;return(0,P.jsx)(u.Z,{style:{color:"black"},children:z()(null===e||void 0===e||null===(l=e.row)||void 0===l?void 0:l.updatedDate).format("h:mm A DD-MM-YYYY")})}}];return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(k.Z,{open:l,handleClose:()=>i(!1)}),(0,P.jsx)(N.Z,{open:C,handleClose:()=>E(!1),id:V}),(0,P.jsx)(R.Z,{open:b,handleClose:()=>w(!1),data:J}),(0,P.jsx)(D.Z,{open:L,onClose:()=>Y(!1),id:V}),(0,P.jsx)(M.Z,{open:$,onClose:()=>A(!1),id:V}),(0,P.jsxs)(p.Z,{children:[(0,P.jsxs)(x.Z,{direction:"row",alignItems:"center",mb:5,justifyContent:"space-between",children:[(0,P.jsx)(u.Z,{variant:"h4",children:"Lead-Management"}),(0,P.jsx)(x.Z,{direction:"row",alignItems:"center",justifyContent:"flex-end",spacing:2,children:(0,P.jsx)(h.Z,{variant:"contained",startIcon:(0,P.jsx)(r.Z,{icon:"eva:plus-fill"}),onClick:()=>i(!0),children:"New Lead"})})]}),(0,P.jsx)(d.Z,{children:(0,P.jsx)(c.Z,{width:"100%",children:(0,P.jsx)(v.Z,{style:{height:"600px",paddingTop:"10px"},children:ae&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)(u.Z,{variant:"h4",sx:{margin:"2px 15px"},children:["Leads ( ",null===ae||void 0===ae?void 0:ae.length," )"]}),(0,P.jsx)(o._$,{rows:ae,columns:te,checkboxSelection:!0,getRowId:e=>null!==e&&void 0!==e&&e._id?null===e||void 0===e?void 0:e._id:null===e||void 0===e?void 0:e.call_id,initialState:{pagination:{paginationModel:{page:0,pageSize:10}}},slots:{toolbar:n.n},pageSizeOptions:[5,20],slotProps:{toolbar:{showQuickFilter:!0}}})]})})})})]})]})}}}]);